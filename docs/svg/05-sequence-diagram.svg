<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1600 1200" width="1600" height="1200">
  <defs>
    <style>
      .title { font: bold 32px 'Inter', sans-serif; fill: #1e3a5f; }
      .subtitle { font: 18px 'Inter', sans-serif; fill: #475569; }
      .lifeline-box { fill: #2563eb; stroke: #1e3a5f; stroke-width: 2; rx: 8; }
      .lifeline-text { font: bold 14px 'Inter', sans-serif; fill: #ffffff; text-anchor: middle; }
      .lifeline-line { stroke: #2563eb; stroke-width: 2; stroke-dasharray: 8,4; }
      .activation-box { fill: #fbbf24; stroke: #f59e0b; stroke-width: 2; }
      .message-arrow { stroke: #1e3a5f; stroke-width: 2.5; fill: none; marker-end: url(#solid-arrow); }
      .return-arrow { stroke: #059669; stroke-width: 2; fill: none; stroke-dasharray: 6,3; marker-end: url(#return-arrow); }
      .message-label { font: 13px 'Inter', sans-serif; fill: #1e3a5f; }
      .note-box { fill: #fef3c7; stroke: #f59e0b; stroke-width: 2; rx: 6; }
      .note-text { font: 12px 'Inter', sans-serif; fill: #1e3a5f; }
      .footer-text { font: 13px 'Inter', sans-serif; fill: #475569; font-style: italic; }
      .alt-box { fill: none; stroke: #7c3aed; stroke-width: 2; stroke-dasharray: 5,5; rx: 8; }
      .alt-label { font: bold 13px 'Inter', sans-serif; fill: #7c3aed; }
      .loop-box { fill: none; stroke: #dc2626; stroke-width: 2; stroke-dasharray: 5,5; rx: 8; }
      .loop-label { font: bold 13px 'Inter', sans-serif; fill: #dc2626; }
    </style>
    <marker id="solid-arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#1e3a5f" />
    </marker>
    <marker id="return-arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#059669" />
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1600" height="1200" fill="#f8fafc"/>

  <!-- Title -->
  <text x="800" y="50" class="title" text-anchor="middle">UML Sequence Diagram</text>
  <text x="800" y="80" class="subtitle" text-anchor="middle">Thesis Upload and AI Analysis Process</text>

  <!-- LIFELINE PARTICIPANTS -->
  <!-- User -->
  <rect x="80" y="120" width="120" height="50" class="lifeline-box"/>
  <text x="140" y="150" class="lifeline-text">User</text>
  <line x1="140" y1="170" x2="140" y2="1100" class="lifeline-line"/>

  <!-- Web Client -->
  <rect x="290" y="120" width="150" height="50" class="lifeline-box"/>
  <text x="365" y="150" class="lifeline-text">Web Client</text>
  <text x="365" y="163" class="lifeline-text" style="font-size: 11px;">(React)</text>
  <line x1="365" y1="170" x2="365" y2="1100" class="lifeline-line"/>

  <!-- API Gateway -->
  <rect x="530" y="120" width="150" height="50" class="lifeline-box"/>
  <text x="605" y="150" class="lifeline-text">API Gateway</text>
  <text x="605" y="163" class="lifeline-text" style="font-size: 11px;">(Backend)</text>
  <line x1="605" y1="170" x2="605" y2="1100" class="lifeline-line"/>

  <!-- Auth Service -->
  <rect x="770" y="120" width="150" height="50" class="lifeline-box"/>
  <text x="845" y="150" class="lifeline-text">Auth Service</text>
  <line x1="845" y1="170" x2="845" y2="1100" class="lifeline-line"/>

  <!-- Processing Service -->
  <rect x="1010" y="120" width="160" height="50" class="lifeline-box"/>
  <text x="1090" y="145" class="lifeline-text">Processing</text>
  <text x="1090" y="160" class="lifeline-text">Service</text>
  <line x1="1090" y1="170" x2="1090" y2="1100" class="lifeline-line"/>

  <!-- AI Service -->
  <rect x="1260" y="120" width="140" height="50" class="lifeline-box"/>
  <text x="1330" y="145" class="lifeline-text">AI Service</text>
  <text x="1330" y="160" class="lifeline-text" style="font-size: 11px;">(External)</text>
  <line x1="1330" y1="170" x2="1330" y2="1100" class="lifeline-line"/>

  <!-- Database -->
  <rect x="1490" y="120" width="120" height="50" class="lifeline-box"/>
  <text x="1550" y="150" class="lifeline-text">Database</text>
  <line x1="1550" y1="170" x2="1550" y2="1100" class="lifeline-line"/>

  <!-- SEQUENCE MESSAGES -->

  <!-- 1. User clicks upload -->
  <path d="M 140 210 L 355 210" class="message-arrow"/>
  <text x="200" y="205" class="message-label">1. Click "Upload Thesis"</text>

  <!-- Activation box for Web Client -->
  <rect x="355" y="210" width="20" height="40" class="activation-box"/>

  <!-- 2. Show file dialog -->
  <path d="M 355 230 L 150 230" class="return-arrow"/>
  <text x="200" y="225" class="message-label">2. Display file selector</text>

  <!-- 3. User selects file -->
  <path d="M 140 270 L 355 270" class="message-arrow"/>
  <text x="200" y="265" class="message-label">3. Select thesis file (PDF)</text>

  <rect x="355" y="270" width="20" height="60" class="activation-box"/>

  <!-- 4. Validate file -->
  <rect x="200" y="300" width="200" height="60" class="note-box"/>
  <text x="210" y="320" class="note-text">Client-side validation:</text>
  <text x="210" y="335" class="note-text">• File type (PDF/DOCX)</text>
  <text x="210" y="350" class="note-text">• File size (max 10MB)</text>

  <!-- 5. POST request to API -->
  <path d="M 375 380 L 595 380" class="message-arrow"/>
  <text x="420" y="375" class="message-label">4. POST /api/thesis/upload</text>
  <text x="420" y="390" class="message-label" style="font-size: 11px;">(FormData with file)</text>

  <rect x="595" y="380" width="20" height="80" class="activation-box"/>

  <!-- 6. Verify authentication -->
  <path d="M 615 410 L 835 410" class="message-arrow"/>
  <text x="680" y="405" class="message-label">5. Verify JWT token</text>

  <rect x="835" y="410" width="20" height="40" class="activation-box"/>

  <!-- 7. Return auth status -->
  <path d="M 835 435 L 625 435" class="return-arrow"/>
  <text x="680" y="430" class="message-label">6. Auth OK</text>

  <!-- ALT: Auth Failed -->
  <rect x="50" y="470" width="400" height="80" class="alt-box"/>
  <text x="60" y="490" class="alt-label">[ALT: Authentication Failed]</text>

  <path d="M 615 510 L 375 510" class="return-arrow"/>
  <text x="420" y="505" class="message-label">Return 401 Unauthorized</text>

  <path d="M 365 530 L 150 530" class="return-arrow"/>
  <text x="200" y="525" class="message-label">Show error message</text>

  <!-- 8. Forward to processing -->
  <path d="M 615 580 L 1080 580" class="message-arrow"/>
  <text x="780" y="575" class="message-label">7. Process document</text>

  <rect x="1080" y="580" width="20" height="420" class="activation-box"/>

  <!-- 9. Parse document -->
  <rect x="950" y="610" width="200" height="60" class="note-box"/>
  <text x="960" y="630" class="note-text">Document parsing:</text>
  <text x="960" y="645" class="note-text">• Extract text content</text>
  <text x="960" y="660" class="note-text">• Identify structure</text>

  <!-- 10. Validate structure -->
  <rect x="1170" y="680" width="100" height="60" fill="#e0f2fe" stroke="#2563eb" stroke-width="2"/>
  <text x="1220" y="700" style="font: 12px 'Inter', sans-serif; fill: #1e3a5f; text-anchor: middle;">Validate</text>
  <text x="1220" y="715" style="font: 12px 'Inter', sans-serif; fill: #1e3a5f; text-anchor: middle;">structure</text>
  <text x="1220" y="730" style="font: 12px 'Inter', sans-serif; fill: #1e3a5f; text-anchor: middle;">(internal)</text>

  <!-- 11. Request AI analysis -->
  <path d="M 1100 770 L 1320 770" class="message-arrow"/>
  <text x="1150" y="765" class="message-label">8. Analyze content</text>
  <text x="1150" y="780" class="message-label" style="font-size: 11px;">(text + metadata)</text>

  <rect x="1320" y="770" width="20" height="140" class="activation-box"/>

  <!-- LOOP: AI Processing -->
  <rect x="1200" y="800" width="250" height="90" class="loop-box"/>
  <text x="1210" y="820" class="loop-label">[LOOP: Multiple AI checks]</text>

  <text x="1210" y="840" class="note-text">• Grammar & style check</text>
  <text x="1210" y="855" class="note-text">• Plagiarism detection</text>
  <text x="1210" y="870" class="note-text">• Content quality analysis</text>
  <text x="1210" y="885" class="note-text">• Citation validation</text>

  <!-- 12. Return AI results -->
  <path d="M 1320 920 L 1110 920" class="return-arrow"/>
  <text x="1160" y="915" class="message-label">9. Analysis results</text>
  <text x="1160" y="930" class="message-label" style="font-size: 11px;">(scores + feedback)</text>

  <!-- 13. Generate feedback report -->
  <rect x="950" y="950" width="220" height="60" class="note-box"/>
  <text x="960" y="970" class="note-text">Generate comprehensive report:</text>
  <text x="960" y="985" class="note-text">• Compile AI feedback</text>
  <text x="960" y="1000" class="note-text">• Format recommendations</text>

  <!-- 14. Save to database -->
  <path d="M 1100 1030 L 1540 1030" class="message-arrow"/>
  <text x="1250" y="1025" class="message-label">10. Store results</text>

  <rect x="1540" y="1030" width="20" height="40" class="activation-box"/>

  <!-- 15. Confirm save -->
  <path d="M 1540 1055 L 1110 1055" class="return-arrow"/>
  <text x="1250" y="1050" class="message-label">11. Saved (ID: 12345)</text>

  <!-- 16. Return to API Gateway -->
  <path d="M 1080 1080 L 625 1080" class="return-arrow"/>
  <text x="780" y="1075" class="message-label">12. Processing complete</text>

  <!-- 17. Send response to client -->
  <path d="M 605 1110 L 385 1110" class="return-arrow"/>
  <text x="420" y="1105" class="message-label">13. 200 OK + Results</text>

  <!-- 18. Display results -->
  <path d="M 365 1140 L 150 1140" class="return-arrow"/>
  <text x="200" y="1135" class="message-label">14. Display dashboard</text>

  <!-- Footer -->
  <text x="800" y="1180" class="footer-text" text-anchor="middle">
    Figure 5: UML Sequence Diagram illustrating the complete flow of thesis upload and AI-powered analysis
  </text>
</svg>
